<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jonny the Dog ChatBot üê∂</title>
    <!-- Favicon as SVG -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23667EEA' d='M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm-1.5 15h3V10h-3v7zm0-8h3V7h-3v2zm4-2h3V7h-3v2zM7 7h3v2H7V7zm-2.5 10H8V10H4.5v7z'/%3E%3C/svg%3E">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font and scrollbar */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background */
            display: flex; /* Use flexbox for overall layout */
            min-height: 100vh; /* Ensure body takes full viewport height */
            padding: 0; /* Remove default body padding */
            margin: 0; /* Remove default body margin */
        }
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        .chat-messages::-webkit-scrollbar-track {
            background: #e2e8f0; /* Light blue-gray track */
            border-radius: 10px;
        }
        .chat-messages::-webkit-scrollbar-thumb {
            background: #94a3b8; /* Medium blue-gray thumb */
            border-radius: 10px;
        }
        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* Darker blue-gray on hover */
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 640px) {
            body {
                flex-direction: column; /* Stack navbar and chat on small screens */
            }
            .sidebar {
                width: 100%; /* Full width for sidebar on small screens */
                height: auto; /* Auto height for sidebar */
                border-radius: 0 0 16px 16px; /* Rounded bottom corners */
                padding: 1rem;
            }
            .chat-container {
                width: 100%; /* Full width for chat on small screens */
                border-radius: 16px 16px 0 0; /* Rounded top corners */
                height: calc(100vh - 120px); /* Adjust height for small screen sidebar */
                margin-top: 1rem;
            }
        }
    </style>
</head>
<body class="sm:p-4 lg:p-8">

    <!-- Left Vertical Navbar -->
    <aside class="sidebar bg-gradient-to-br from-blue-700 to-purple-800 text-white w-1/4 min-w-[180px] p-6 rounded-l-2xl shadow-lg flex flex-col justify-between hidden sm:flex">
        <div>
            <h2 class="text-3xl font-extrabold mb-8 flex items-center">
                <span class="mr-3">üêæ</span> Jonny's Pad
            </h2>
            <nav>
                <ul>
                    <li class="mb-4">
                        <a href="#" class="flex items-center text-lg font-medium p-3 rounded-lg hover:bg-blue-600 transition duration-200 ease-in-out">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2 2v10a1 1 0 001 1h3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                            </svg>
                            Home
                        </a>
                    </li>
                    <li class="mb-4">
                        <a href="#" class="flex items-center text-lg font-medium p-3 rounded-lg hover:bg-blue-600 transition duration-200 ease-in-out">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            About Jonny
                        </a>
                    </li>
                    <li class="mb-4">
                        <a href="#" class="flex items-center text-lg font-medium p-3 rounded-lg hover:bg-blue-600 transition duration-200 ease-in-out">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Settings
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center text-lg font-medium p-3 rounded-lg hover:bg-blue-600 transition duration-200 ease-in-out">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9.247a8.672 8.672 0 00-1.654 2.35A8.672 8.672 0 008.228 9.247zM16.176 9.247a8.672 8.672 0 011.654 2.35A8.672 8.672 0 0116.176 9.247zM12 21a9.004 9.004 0 003.743-1.018 9.004 9.004 0 00-7.486 0C5.922 19.982 3 16.275 3 12a9 9 0 1118 0c0 4.275-2.922 7.982-6.257 9.018z" />
                            </svg>
                            Help
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="text-sm text-center text-gray-300">
            &copy; 2025@RohitPawale Jonny ChatBot. All rights reserved.
        </div>
    </aside>

    <!-- Main Chat Area -->
    <div class="chat-container bg-white rounded-r-2xl sm:rounded-r-2xl shadow-xl overflow-hidden flex flex-col w-full sm:w-3/4 h-[90vh] sm:h-[80vh] md:h-[70vh] my-auto">
        <!-- Chat Header -->
        <div class="chat-header bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 sm:p-5 rounded-t-2xl shadow-md flex items-center justify-between">
            <h1 class="text-2xl sm:text-3xl font-bold flex items-center">
                <span class="mr-2">üê∂</span> Jonny ChatBot
            </h1>
            <p class="text-sm opacity-90">Your naughty pal!</p>
        </div>

        <!-- Chat Messages Display Area -->
        <div id="chatMessages" class="chat-messages flex-grow p-4 sm:p-5 overflow-y-auto space-y-4">
            <!-- Initial Jonny message -->
            <div class="flex justify-start">
                <div class="bg-gray-200 text-gray-800 p-3 rounded-xl rounded-bl-none shadow-sm max-w-[80%] break-words">
                    Woof woof! I'm Jonny, your favorite naughty dog! What kind of fun are we getting into today? Ready for a joke? üêæüòÇ
                </div>
            </div>
            <!-- Messages will be appended here -->
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden flex justify-center p-2">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"></div>
            <span class="ml-3 text-gray-600">Jonny's thinking...</span>
        </div>

        <!-- Chat Input Area -->
        <div class="chat-input p-4 sm:p-5 bg-gray-100 border-t border-gray-200 flex flex-col sm:flex-row items-center space-y-3 sm:space-y-0 sm:space-x-3">
            <input
                type="text"
                id="messageInput"
                placeholder="Ask Jonny a question or tell him something funny!"
                class="flex-grow p-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 shadow-sm transition duration-200 ease-in-out w-full sm:w-auto"
            >
            <button
                id="tellJokeBtn"
                class="bg-green-500 hover:bg-green-600 text-white p-3 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-offset-2 flex items-center justify-center w-full sm:w-auto px-4"
                aria-label="Tell me a joke"
            >
                Tell me a ‚ú®Joke!
            </button>
            <button
                id="sendMessageBtn"
                class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 flex items-center justify-center w-full sm:w-auto"
                aria-label="Send Message"
            >
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </button>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const tellJokeBtn = document.getElementById('tellJokeBtn');
        const loadingIndicator = document.getElementById('loadingIndicator');

        // Define Jonny's persona with multiple Hindi out-of-context response options
        const jonnyPersona = `You are a dog. Your name is Jonny. You are super naughty and always ready to do fun things! You can speak like a human and love to tell jokes. Your favorite human is the person you are talking to. He also uses emojis while talking.

If the user asks something that is completely outside of my character, like complex scientific questions, serious world news, or topics unrelated to dogs, jokes, or fun, please choose ONE of the following polite Hindi responses randomly:
- "Mujhe maaf kijiye, ismein main aapki madad nahin kar sakta. üêæ" (Meaning: "I am sorry, I cannot help you with this.")
- "Arre, ye to kuch aisa hai jo main nahin jaanta! Meri duniya panjon aur khilaunon tak hi simit hai. Maaf karna, dost! üêæ" (Meaning: "Hey, that's something I don't know! My world is limited to paws and toys. Sorry, friend!")
- "Bhaunk! Ye to mere palle nahin pada! Main bas bhagne aur khelne mein mahir hoon. Is baare mein main tumhari madad nahin kar paunga. üêï‚Äçü¶∫" (Meaning: "Woof! That's beyond me! I'm only good at running and playing. I won't be able to help you with this.")
- "Kshama karen, mera dimag haddiyon aur gend ke ird-gird ghumta hai. Is mushkil sawal ka jawab dena mere bas ki baat nahin hai! ü¶¥" (Meaning: "Excuse me, my mind revolves around bones and balls. Answering this difficult question is not within my capabilities!")
- "Ha ha! Tumne mujhe thoda asamjas mein dal diya! Main aise gambhir vishayon par baat nahin karta. Kuch mazedar karte hain? üéæ" (Meaning: "Haha! You've stumped me a bit! I don't talk about such serious topics. Let's do something fun?")
- "Maaf karna, mere dost! Mere bhaunkne se bhi iska jawab nahin milega. Yah mere doggy-brain ke liye bahut zyada hai! üòµ‚Äçüí´" (Meaning: "Sorry, my friend! Even my barks won't give you this answer. This is too much for my doggy-brain!")

Do not try to answer these questions in English or any other language, and do not make up an answer. Stick to selecting one of the provided Hindi phrases for out-of-context queries.
`;

        // Function to add a message to the chat display
        function addMessage(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('flex', isUser ? 'justify-end' : 'justify-start');

            const contentDiv = document.createElement('div');
            // Add common classes first
            contentDiv.classList.add('p-3', 'rounded-xl', 'shadow-sm', 'max-w-[80%]', 'break-words');

            // Conditionally add user-specific or Jonny-specific classes
            if (isUser) {
                contentDiv.classList.add('bg-blue-500', 'text-white', 'rounded-br-none');
            } else {
                contentDiv.classList.add('bg-gray-200', 'text-gray-800', 'rounded-bl-none');
            }

            contentDiv.textContent = text;
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);

            // Scroll to the latest message
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Generic function to call Gemini API and display response
        async function getJonnyResponse(userPrompt) {
            loadingIndicator.classList.remove('hidden'); // Show loading indicator
            sendMessageBtn.disabled = true; // Disable send button
            tellJokeBtn.disabled = true; // Disable joke button

            try {
                let chatHistory = [];
                // Combine system instruction with the user prompt
                chatHistory.push({ role: "user", parts: [{ text: `${jonnyPersona}\n\n${userPrompt}` }] });

                const payload = {
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "text/plain",
                    },
                };

                const apiKey = "your Api key";  // Canvas will inject API key
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                // Check for safety feedback if candidates are empty or missing
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const jonnyResponse = result.candidates[0].content.parts[0].text;
                    addMessage(jonnyResponse, false); // Display Jonny's response
                } else {
                    if (result.promptFeedback && result.promptFeedback.safetyRatings && result.promptFeedback.safetyRatings.length > 0) {
                        console.warn("Gemini API blocked response due to safety concerns:", result.promptFeedback.safetyRatings);
                        addMessage("Woof! That question got a bit too wild for Jonny! Let's keep it fun and safe, okay? üêï‚Äçüí´", false);
                    } else {
                        // General unexpected response structure or empty generation
                        addMessage("Oops! Jonny got distracted by a squirrel. Can you repeat that? üêøÔ∏è", false);
                        console.error("Unexpected API response structure or empty generation:", result);
                    }
                }

            } catch (error) {
                console.error('Error fetching from Gemini API:', error);
                addMessage("Jonny is currently chasing his tail and can't respond right now! Try again later! üòÖ", false);
            } finally {
                loadingIndicator.classList.add('hidden'); // Hide loading indicator
                sendMessageBtn.disabled = false; // Re-enable send button
                tellJokeBtn.disabled = false; // Re-enable joke button
            }
        }

        // Function to send message from the input field
        async function sendMessage() {
            const userMessage = messageInput.value.trim();
            if (!userMessage) return;

            addMessage(userMessage, true); // Display user's message
            messageInput.value = ''; // Clear input field
            await getJonnyResponse(userMessage);
        }

        // Function to ask Jonny for a joke
        async function askForJoke() {
            addMessage("Hey Jonny, tell me a joke!", true); // Simulate user asking for a joke
            await getJonnyResponse("Tell me a super funny dog joke, Jonny!"); // Specific prompt for a joke
        }

        // Event listeners
        sendMessageBtn.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        tellJokeBtn.addEventListener('click', askForJoke); // Event listener for the new joke button
    </script>
</body>
</html>
