
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSA Buddy - Your Personal DSA Instructor</title>
    <!-- Favicon: A book emoji for DSA theme -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">
    <!-- External CSS for Font Awesome icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Font for 'Inter' -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <!-- Embedded CSS for styling -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; /* Dark background for black theme */
            color: #f0f0f0; /* Light text for dark theme */
            line-height: 1.6;
            scroll-behavior: smooth; /* Smooth scrolling for navigation */
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px 0;
        }

        header {
            background-color: #b30000; /* Red for header */
            color: white;
            padding: 15px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* Stronger shadow */
            border-bottom-left-radius: 15px; /* More rounded */
            border-bottom-right-radius: 15px; /* More rounded */
            border-bottom: 3px solid #ff3333; /* Accent border */
        }

        header .logo h1 {
            margin: 0;
            font-size: 2.5em; /* Larger logo */
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5); /* Stronger text shadow */
            letter-spacing: 1.5px; /* Spaced out letters */
            font-weight: 700;
        }

        header nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px; /* Gap between menu items */
        }

        header nav ul li {
            margin: 0; /* Remove individual margins as gap handles it */
        }

        header nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 10px 18px; /* Increased padding */
            transition: all 0.3s ease-in-out; /* Smoother transition */
            border-radius: 10px; /* More rounded corners */
            position: relative;
            overflow: hidden;
            font-size: 1.1em; /* Slightly larger font */
            text-transform: uppercase; /* Uppercase for menu items */
            letter-spacing: 0.5px;
        }

        header nav ul li a:hover,
        header nav ul li a.active {
            background-color: rgba(255,51,51,0.8); /* Lighter red on hover */
            transform: translateY(-3px) scale(1.05); /* More pronounced lift and scale */
            box-shadow: 0 6px 12px rgba(0,0,0,0.25); /* Stronger shadow on hover */
            border: 1px solid #ffcccc; /* Light border on hover */
        }

        .hero-section {
            background-color: #333333; /* Dark grey for hero */
            color: #f0f0f0;
            padding: 60px 20px;
            text-align: center;
            border-radius: 10px; /* More rounded */
            margin-top: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.25); /* Stronger shadow */
            border: 1px solid #444444; /* Border for section */
        }

        .hero-section h2 {
            color: #ff3333; /* Red heading */
            font-size: 2.8em; /* Larger heading */
            margin-bottom: 20px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
        }

        .hero-section p {
            font-size: 1.2em; /* Larger text */
            max-width: 900px;
            margin: 0 auto;
        }

        #chat-interface {
            margin-top: 40px;
            background-color: #222222; /* Darker background for chat interface */
            border-radius: 10px; /* More rounded */
            box-shadow: 0 6px 12px rgba(0,0,0,0.3); /* Stronger shadow */
            padding: 20px;
            border: 1px solid #444444;
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px; /* Fixed height for chat area */
            border: 1px solid #555555; /* Darker border */
            border-radius: 10px;
            overflow: hidden;
            background-color: #2b2b2b; /* Slightly lighter inner chat background */
        }

        .chat-output {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #2b2b2b;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }

        .user-message {
            justify-content: flex-end;
        }

        .user-message p {
            background-color: #ff3333; /* Red for user messages */
            color: white;
            padding: 12px 18px; /* Increased padding */
            border-radius: 25px 25px 5px 25px; /* More rounded on top/left/right */
            max-width: 75%; /* Slightly wider messages */
            word-wrap: break-word;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2); /* Subtle shadow */
        }

        .bot-message {
            justify-content: flex-start;
        }

        .bot-message p {
            background-color: #444444; /* Dark grey for bot messages */
            color: #f0f0f0;
            padding: 12px 18px; /* Increased padding */
            border-radius: 25px 25px 25px 5px; /* More rounded on top/left/right */
            max-width: 75%; /* Slightly wider messages */
            word-wrap: break-word;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }

        .code-block {
            background-color: #000000; /* Pure black for code blocks */
            color: #00ff00; /* Green text for code */
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            position: relative;
            overflow-x: auto;
            box-shadow: 0 4px 8px rgba(0,0,0,0.5); /* Stronger shadow */
            border: 1px solid #ff3333; /* Red border for code block */
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap; /* Ensures long lines wrap */
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #ff9999; /* Lighter red for code header */
            font-size: 0.9em;
            padding-bottom: 5px;
            border-bottom: 1px solid #666666;
        }

        .copy-button {
            background-color: #660000; /* Darker red for copy button */
            color: white;
            border: none;
            padding: 6px 12px; /* Slightly larger button */
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.2s ease, transform 0.1s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .copy-button:hover {
            background-color: #800000; /* Lighter red on hover */
            transform: translateY(-1px);
        }
        .copy-button:active {
            transform: translateY(0);
        }


        .chat-input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid #333333;
            background-color: #222222; /* Dark background */
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        .chat-input-area input {
            flex-grow: 1;
            padding: 12px 18px; /* Increased padding */
            border: 1px solid #555555; /* Darker border */
            border-radius: 30px; /* More rounded */
            font-size: 1.05em;
            margin-right: 15px; /* More spacing */
            outline: none;
            background-color: #333333; /* Darker input background */
            color: #f0f0f0;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .chat-input-area input::placeholder {
            color: #aaaaaa; /* Lighter placeholder text */
        }

        .chat-input-area input:focus {
            border-color: #ff3333; /* Red border on focus */
            box-shadow: 0 0 0 4px rgba(255,51,51,0.3); /* Red glow on focus */
        }

        .chat-input-area button {
            background-color: #ff3333; /* Red button */
            color: white;
            border: none;
            border-radius: 30px; /* More rounded */
            padding: 12px 25px; /* Larger padding */
            cursor: pointer;
            font-size: 1.1em; /* Larger font */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .chat-input-area button:hover {
            background-color: #cc0000; /* Darker red on hover */
            transform: translateY(-2px); /* More pronounced lift */
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        .chat-input-area button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .chat-input-area button i {
            margin-left: 5px;
        }

        .info-section {
            background-color: #222222; /* Darker background for info sections */
            color: #f0f0f0;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.25);
            margin-top: 30px;
            border: 1px solid #444444;
        }

        .info-section h2 {
            color: #ff3333; /* Red heading */
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.2em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
        }

        .info-section ul {
            list-style: none;
            padding: 0;
        }

        .info-section ul li {
            background-color: #333333; /* Darker background for list items */
            color: #f0f0f0;
            margin-bottom: 10px;
            padding: 15px 25px; /* Increased padding */
            border-left: 5px solid #ff3333; /* Red accent border */
            border-radius: 8px;
            font-size: 1.1em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }

        .info-section p {
            text-align: center;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .info-section a {
            color: #ff6666; /* Lighter red for links */
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s ease;
        }

        .info-section a:hover {
            text-decoration: underline;
            color: #ff9999;
        }

        .rules {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
        }

        .do-list, .dont-list {
            background-color: #2b2b2b; /* Slightly lighter dark for rule boxes */
            padding: 25px; /* More padding */
            border-radius: 10px;
            flex: 1;
            min-width: 320px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            border: 1px solid #555555;
        }

        .do-list h3 {
            color: #66ff66; /* Green for "Do's" heading */
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.6em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .dont-list h3 {
            color: #ff6666; /* Red for "Don'ts" heading */
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.6em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .do-list li {
            color: #f0f0f0;
            border-left-color: #66ff66; /* Green border for Do's list items */
            background-color: #3d3d3d; /* Darker list item background */
            font-size: 1em;
        }

        .dont-list li {
            color: #f0f0f0;
            border-left-color: #ff6666; /* Red border for Don'ts list items */
            background-color: #3d3d3d; /* Darker list item background */
            font-size: 1em;
        }


        footer {
            background-color: #000000; /* Black footer */
            color: white;
            text-align: center;
            padding: 25px 0; /* More padding */
            margin-top: 50px;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            box-shadow: 0 -4px 8px rgba(0,0,0,0.3);
            border-top: 3px solid #b30000; /* Red accent border */
        }

        footer p {
            margin: 0;
            font-size: 0.95em;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            header nav ul {
                flex-direction: column;
                align-items: center;
            }

            header nav ul li {
                margin: 10px 0;
            }

            .hero-section {
                padding: 40px 15px;
            }

            .hero-section h2 {
                font-size: 2em;
            }

            .chat-container {
                height: 400px;
            }

            .chat-input-area {
                flex-direction: column;
            }

            .chat-input-area input {
                margin-right: 0;
                margin-bottom: 10px;
                border-radius: 5px;
            }

            .chat-input-area button {
                width: 100%;
                border-radius: 5px;
            }

            .info-section {
                padding: 20px;
            }

            .info-section h2 {
                font-size: 1.8em;
            }

            .rules {
                flex-direction: column;
            }

            .do-list, .dont-list {
                min-width: unset;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1>DSA Buddy</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="#home" class="active">Home</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#dos-donts">Do's & Don'ts</a></li>
                    <li><a href="#contact">Contact Us</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="home" class="hero-section">
            <h2>Welcome to DSA Buddy! üëã</h2>
            <p>Your ultimate guide to mastering Data Structures and Algorithms. Ask any DSA-related question and get clear, concise, and expert explanations.</p>
        </section>

        <section id="chat-interface">
            <div class="chat-container">
                <div id="chat-output" class="chat-output">
                    <div class="message bot-message">
                        <p>Hello! I am DSA Buddy, your dedicated Data Structures and Algorithms instructor. How can I help you today? ü§î</p>
                    </div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="user-question" placeholder="Ask your DSA question here...">
                    <button id="send-button"><i class="fas fa-paper-plane"></i> Send</button>
                </div>
            </div>
        </section>

        <section id="features" class="info-section">
            <h2>‚ú® Features of DSA Buddy</h2>
            <ul>
                <li><strong>In-depth Explanations:</strong> Get detailed, yet simple, explanations of complex DSA concepts.</li>
                <li><strong>Problem Breakdown:</strong> Learn how to break down complex problems into manageable parts.</li>
                <li><strong>Polite and Clear:</strong> Answers are always polite and easy to understand (for DSA topics üòâ).</li>
                <li><strong>Quick Responses:</strong> Get your queries resolved instantly.</li>
                <li><strong>Code Snippets:</strong> Relevant code examples (where applicable) to solidify your understanding.</li>
            </ul>
        </section>

        <section id="about" class="info-section">
            <h2>‚ÑπÔ∏è About DSA Buddy</h2>
            <p>DSA Buddy is an AI-powered Data Structures and Algorithms instructor designed to help learners of all levels. Our goal is to make learning DSA accessible and enjoyable by providing expert guidance in a straightforward manner. Built with cutting-edge AI, DSA Buddy understands your questions and provides comprehensive, easy-to-digest answers.</p>
        </section>

        <section id="dos-donts" class="info-section">
            <h2>‚úÖ Do's and ‚ùå Don'ts with DSA Buddy</h2>
            <div class="rules">
                <div class="do-list">
                    <h3>‚úÖ Do's:</h3>
                    <ul>
                        <li><strong>Ask about Arrays:</strong> "What is an array?", "Explain array operations."</li>
                        <li><strong>Inquire about Linked Lists:</strong> "How does a linked list work?", "Types of linked lists."</li>
                        <li><strong>Seek explanations on Trees & Graphs:</strong> "What is a binary tree?", "DFS vs BFS."</li>
                        <li><strong>Explore Sorting & Searching:</strong> "Explain Merge Sort," "Binary Search algorithm."</li>
                        <li><strong>Understand Time & Space Complexity:</strong> "What is Big O notation?"</li>
                    </ul>
                </div>
                <div class="dont-list">
                    <h3>‚ùå Don'ts:</h3>
                    <ul>
                        <li><strong>Ask about current events:</strong> "What's the weather like?"</li>
                        <li><strong>Inquire about personal opinions:</strong> "Do you like pizza?"</li>
                        <li><strong>Ask non-technical questions:</strong> "What is the capital of France?"</li>
                        <li><strong>Discuss politics or sensitive topics.</strong></li>
                        <li><strong>Engage in idle chat.</strong></li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="contact" class="info-section">
            <h2>üìû Contact Us</h2>
            <p>Have suggestions or feedback for DSA Buddy? We'd love to hear from you!</p>
            <p>Email: <a href="mailto:support@dsabuddy.com">support@dsabuddy.com</a></p>
            <p>Follow us on: <a href="https://twitter.com/DSABuddy" target="_blank">Twitter</a> | <a href="https://linkedin.com/company/dsabuddy" target="_blank">LinkedIn</a></p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; RohitPawale@2025 DSA Buddy. All rights reserved.</p>
        </div>
    </footer>

    <!-- Embedded JavaScript for functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userQuestionInput = document.getElementById('user-question');
            const sendButton = document.getElementById('send-button');
            const chatOutput = document.getElementById('chat-output');

            // Define the system instruction for the DSA Instructor Chatbot
            const dsaInstructorPersona = `You are an Data Structures and Algorithms Instructure. you have indepth knowledge of data structures and algorithms you have ability to break down complex problems in simple form and explain it in simple language so anyone can understand.

If user ask you any other question which is not related to data structures and algorithm then give them response very rudely 
in hinglish like
example : ye mera kam nahi hai kuch bhi mat pucho
tum kya chakara gaye ho kya 
me pagal hu kya ? kuch bhi mat pucho ? DSA ke bare me pucho generate similar responses

sometimes also generate english response like you dumb ask me sensible question
generate similar responses

if User ask you question related to Data structures and Algorithms then answer it pointwise in simplest way politely with explanation
`;

            // Function to scroll chat to the bottom
            const scrollToBottom = () => {
                chatOutput.scrollTop = chatOutput.scrollHeight;
            };

            // Function to format text with bolding and lists
            const formatText = (text) => {
                // Convert bold markdown **text** to <strong>text</strong>
                let formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

                // Convert list items starting with numbers or hyphens to ordered/unordered lists
                // This regex looks for lines starting with a number followed by a period and space, or a hyphen/asterisk and space
                const lines = formattedText.split('\n');
                let inList = false;
                let listType = ''; // 'ul' or 'ol'
                let processedLines = [];

                lines.forEach(line => {
                    const trimmedLine = line.trim();
                    const isListItem = trimmedLine.match(/^(\d+\.\s|-\s|\*\s)(.*)/);

                    if (isListItem) {
                        const marker = isListItem[1];
                        const content = isListItem[2];
                        const currentListType = marker.match(/^\d+\./) ? 'ol' : 'ul';

                        if (!inList) {
                            listType = currentListType;
                            processedLines.push(`<${listType}>`);
                            inList = true;
                        } else if (listType !== currentListType) {
                            // If list type changes, close current list and open new one
                            processedLines.push(`</${listType}>`);
                            listType = currentListType;
                            processedLines.push(`<${listType}>`);
                        }
                        processedLines.push(`<li>${content}</li>`);
                    } else {
                        if (inList) {
                            processedLines.push(`</${listType}>`);
                            inList = false;
                        }
                        processedLines.push(line); // Add non-list line as is
                    }
                });

                if (inList) {
                    processedLines.push(`</${listType}>`);
                }
                
                return processedLines.join('\n');
            };

            // Function to add a message to the chat display
            const addMessage = (text, sender) => {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message', `${sender}-message`);

                const messageContent = document.createElement('p'); // Use <p> for main content

                if (sender === 'bot') {
                    // Regex to identify code blocks: ```[language]\n[code]```
                    const codeRegex = /```(\w+)?\n([\s\S]*?)```/g;
                    let lastIndex = 0;
                    let currentText = text; // Work with a mutable copy of the text

                    let match;
                    const parts = [];

                    // Extract code blocks first
                    while ((match = codeRegex.exec(currentText)) !== null) {
                        // Add text before the code block
                        if (match.index > lastIndex) {
                            // Format non-code text before adding
                            parts.push(formatText(currentText.substring(lastIndex, match.index)));
                        }

                        // Capture the code content for this specific button's click handler
                        const codeToCopy = match[2].trim();

                        const codeBlockDiv = document.createElement('div');
                        codeBlockDiv.classList.add('code-block');

                        const codeHeader = document.createElement('div');
                        codeHeader.classList.add('code-header');

                        const codeLanguage = document.createElement('span');
                        codeLanguage.textContent = match[1] ? `Language: ${match[1].toUpperCase()}` : 'Code';
                        codeHeader.appendChild(codeLanguage);

                        const copyButton = document.createElement('button');
                        copyButton.classList.add('copy-button');
                        copyButton.innerHTML = '<i class="fas fa-copy"></i> Copy';
                        copyButton.onclick = () => {
                            const tempTextArea = document.createElement('textarea');
                            tempTextArea.value = codeToCopy;
                            document.body.appendChild(tempTextArea);
                            tempTextArea.select();
                            document.execCommand('copy');
                            document.body.removeChild(tempTextArea);

                            copyButton.textContent = 'Copied!';
                            setTimeout(() => copyButton.innerHTML = '<i class="fas fa-copy"></i> Copy', 2000);
                        };
                        codeHeader.appendChild(copyButton);

                        codeBlockDiv.appendChild(codeHeader);

                        const pre = document.createElement('pre');
                        pre.textContent = codeToCopy;
                        codeBlockDiv.appendChild(pre);

                        parts.push(codeBlockDiv.outerHTML); // Add the HTML string of the code block
                        lastIndex = codeRegex.lastIndex;
                    }

                    // Add any remaining text after the last code block
                    if (lastIndex < currentText.length) {
                        parts.push(formatText(currentText.substring(lastIndex)));
                    }
                    
                    messageContent.innerHTML = parts.join(''); // Join all parts as innerHTML
                    messageDiv.appendChild(messageContent);
                } else {
                    // For user messages, just add plain text directly
                    messageContent.textContent = text;
                    messageDiv.appendChild(messageContent);
                }

                chatOutput.appendChild(messageDiv);
                scrollToBottom();
            };

            // Generic function to call Gemini API (or your backend proxy) and display response
            async function getDSABuddyResponse(userPrompt) {
                const loadingIndicator = document.createElement('div');
                loadingIndicator.classList.add('message', 'bot-message', 'typing-indicator');
                loadingIndicator.innerHTML = '<p>DSA Buddy is thinking... üí¨</p>';
                chatOutput.appendChild(loadingIndicator);
                scrollToBottom();
                sendButton.disabled = true;

                // IMPORTANT: Use your actual Google GenAI API Key here.
                // This is only for direct client-side calls to Gemini API.
                // For secure production, use a backend proxy.
                const apiKey = "your Api key"; 
                
                // --- Direct API call to Google GenAI ---
                // For this to work directly in the browser, your API key must be valid.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                let chatHistory = [];
                // Combine system instruction with the user prompt for the API call
                chatHistory.push({ role: "user", parts: [{ text: `${dsaInstructorPersona}\n\nUser query: ${userPrompt}` }] });

                const payload = {
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "text/plain",
                    },
                };

                console.log("Attempting to fetch from API...");
                console.log("API URL:", apiUrl);
                console.log("Payload:", payload);

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    console.log("API Response Status:", response.status);
                    
                    // Remove the typing indicator
                    chatOutput.removeChild(loadingIndicator);

                    if (!response.ok) {
                        // Attempt to parse error response from API if available
                        let errorDetails = 'No additional error details available.';
                        try {
                            const errorJson = await response.json();
                            errorDetails = JSON.stringify(errorJson, null, 2);
                        } catch (parseError) {
                            errorDetails = await response.text();
                        }
                        throw new Error(`API returned an error: ${response.status} ${response.statusText}\nDetails: ${errorDetails}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const botResponse = result.candidates[0].content.parts[0].text;
                        addMessage(botResponse, 'bot'); // Display DSA Buddy's response
                    } else {
                        if (result.promptFeedback && result.promptFeedback.safetyRatings && result.promptFeedback.safetyRatings.length > 0) {
                            console.warn("Gemini API blocked response due to safety concerns:", result.promptFeedback.safetyRatings);
                            addMessage("I'm sorry, I cannot provide a response for that query due to safety guidelines. Please ask a question related to Data Structures and Algorithms. üõ°Ô∏è", 'bot');
                        } else {
                            addMessage("I'm sorry, I encountered an unexpected issue. Please try your question again. ü§∑‚Äç‚ôÇÔ∏è", 'bot');
                            console.error("Unexpected API response structure or empty generation:", result);
                        }
                    }

                } catch (error) {
                    console.error('Error fetching from Google GenAI API:', error);
                    chatOutput.removeChild(loadingIndicator);
                    
                    // Specific message for "Failed to fetch" often caused by network/CORS/API Key issues
                    if (error.message.includes('Failed to fetch')) {
                         addMessage(`Oops! I couldn't reach my knowledge base. This usually means:
                            1. Your internet connection is unstable.
                            2. There might be a temporary issue with the API service.
                            3. Your API key might have restrictions (e.g., HTTP referrer) or be invalid for direct browser use.
                            Please check your network and API key setup. üåê (Error: ${error.message})`, 'bot');
                    } else {
                        addMessage(`Oops! I am having trouble connecting to my knowledge base. This might be a network issue. Please try again. üåê (Error: ${error.message})`, 'bot');
                    }
                } finally {
                    sendButton.disabled = false;
                }
            }

            // Function to send message from the input field
            const sendMessage = async () => {
                const userMessage = userQuestionInput.value.trim();
                if (!userMessage) return;

                addMessage(userMessage, 'user'); // Display user's message
                userQuestionInput.value = ''; // Clear input field
                await getDSABuddyResponse(userMessage);
            };

            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            userQuestionInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Handle navigation to sections
            document.querySelectorAll('nav ul li a').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault(); // Prevent default anchor link behavior

                    // Remove 'active' class from previously active link
                    document.querySelector('nav ul li a.active')?.classList.remove('active');
                    // Add 'active' class to the clicked link
                    this.classList.add('active');

                    const targetId = this.getAttribute('href').substring(1); // Get the section ID from href
                    const targetSection = document.getElementById(targetId);

                    if (targetSection) {
                        targetSection.scrollIntoView({
                            behavior: 'smooth' // Smooth scroll to the section
                        });
                    }
                });
            });

        });
    </script>
</body>
</html>
